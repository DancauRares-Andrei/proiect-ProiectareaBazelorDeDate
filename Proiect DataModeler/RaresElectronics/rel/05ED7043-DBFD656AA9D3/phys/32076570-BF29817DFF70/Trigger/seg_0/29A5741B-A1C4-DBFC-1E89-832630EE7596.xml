<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="trg_tranzactie" directorySegmentName="seg_0" id="29A5741B-A1C4-DBFC-1E89-832630EE7596">
<createdBy>rares</createdBy>
<createdTime>2024-04-23 10:07:38 UTC</createdTime>
<ownerDesignName>RaresElectronics</ownerDesignName>
<actions>INSERT, UPDATE</actions>
<body><![CDATA[DECLARE
    v_stoc_magazie NUMBER;
BEGIN
    SELECT stoc_disponibil
    INTO v_stoc_magazie
    FROM magazie
    WHERE produs_id_p_cr = :NEW.produse_id_p_cr;

    IF v_stoc_magazie < :NEW.cantitate_dorita THEN
        raise_application_error(-20001, 'Stoc insuficient produs.');
    ELSE
        UPDATE magazie
        SET stoc_disponibil = v_stoc_magazie - :NEW.cantitate_dorita
        WHERE produs_id_p_cr = :NEW.produse_id_p_cr;
    END IF;
END;
/]]></body>
<triggerTime>BEFORE</triggerTime>
<table>2D83CB17-84B7-9919-36EA-186D46B08297</table>
</TriggerOraclev10g>
